!function(){function t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){var r;r=n[e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r})}return t}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function n(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n,r,l=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=l){var o=[],a=!0,u=!1;try{for(l=l.call(t);!(a=(n=l.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){u=!0,r=t}finally{try{a||null==l.return||l.return()}finally{if(u)throw r}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}}(t,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=new/*#__PURE__*/(function(){var e;function r(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.state=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.score=0,this.status="idle",this.moved=!1,this.nextCellId=1}return e=[{key:"getState",value:function(){return this.state}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"moveLeft",value:function(){var e=this.state.map(function(e){return e.map(function(e){return e?t({},e):null})}),n=[];this.moved=!1;for(var r=0;r<e.length;r++)for(var l=[!1,!1,!1,!1],o=0;o<e[r].length;o++)if(null!==e[r][o]){for(var a=o;a>0&&null===e[r][a-1];)a--;a!==o&&(e[r][a]=e[r][o],e[r][o]=null,this.moved=!0,n.push({id:e[r][a].id,type:"move",from:[r,o],to:[r,a]})),a>0&&null!==e[r][a-1]&&e[r][a].value===e[r][a-1].value&&!l[a-1]&&(n.push({id:e[r][a].id,type:"merge",from:[r,a],to:[r,a-1],mergeIntoId:e[r][a-1].id}),e[r][a-1].value*=2,this.score+=e[r][a-1].value,e[r][a]=null,l[a-1]=!0,this.moved=!0)}return{newState:e,transitions:n,moved:this.moved}}},{key:"moveRight",value:function(){var e=this.state.map(function(e){return e.map(function(e){return e?t({},e):null})}),n=[];this.moved=!1;for(var r=0;r<e.length;r++)for(var l=[!1,!1,!1,!1],o=e[r].length-1;o>=0;o--)if(null!==e[r][o]){for(var a=o;a<e[r].length-1&&null===e[r][a+1];)a++;a!==o&&(e[r][a]=e[r][o],e[r][o]=null,this.moved=!0,n.push({id:e[r][a].id,type:"move",from:[r,o],to:[r,a]})),a<e[r].length-1&&null!==e[r][a+1]&&e[r][a].value===e[r][a+1].value&&!l[a+1]&&(n.push({id:e[r][a].id,type:"merge",from:[r,a],to:[r,a+1],mergeIntoId:e[r][a+1].id}),e[r][a+1].value*=2,this.score+=e[r][a+1].value,e[r][a]=null,l[a+1]=!0,this.moved=!0)}return{newState:e,transitions:n,moved:this.moved}}},{key:"moveUp",value:function(){var e=this.state.map(function(e){return e.map(function(e){return e?t({},e):null})}),n=[];this.moved=!1;for(var r=0;r<e[0].length;r++)for(var l=[!1,!1,!1,!1],o=0;o<e.length;o++)if(null!==e[o][r]){for(var a=o;a>0&&null===e[a-1][r];)a--;a!==o&&(e[a][r]=e[o][r],e[o][r]=null,this.moved=!0,n.push({id:e[a][r].id,type:"move",from:[o,r],to:[a,r]})),a>0&&null!==e[a-1][r]&&e[a][r].value===e[a-1][r].value&&!l[a-1]&&(n.push({id:e[a][r].id,type:"merge",from:[a,r],to:[a-1,r],mergeIntoId:e[a-1][r].id}),e[a-1][r].value*=2,this.score+=e[a-1][r].value,e[a][r]=null,l[a-1]=!0,this.moved=!0)}return{newState:e,transitions:n,moved:this.moved}}},{key:"moveDown",value:function(){var e=this.state.map(function(e){return e.map(function(e){return e?t({},e):null})}),n=[];this.moved=!1;for(var r=0;r<e[0].length;r++)for(var l=[!1,!1,!1,!1],o=e.length-1;o>=0;o--)if(null!==e[o][r]){for(var a=o;a<e.length-1&&null===e[a+1][r];)a++;a!==o&&(e[a][r]=e[o][r],e[o][r]=null,this.moved=!0,n.push({id:e[a][r].id,type:"move",from:[o,r],to:[a,r]})),a<e.length-1&&null!==e[a+1][r]&&e[a][r].value===e[a+1][r].value&&!l[a+1]&&(n.push({id:e[a][r].id,type:"merge",from:[a,r],to:[a+1,r],mergeIntoId:e[a+1][r].id}),e[a+1][r].value*=2,this.score+=e[a+1][r].value,e[a][r]=null,l[a+1]=!0,this.moved=!0)}return{newState:e,transitions:n,moved:this.moved}}},{key:"defineStep",value:function(t,e){var r=n(t,2),l=r[0],o=r[1],a=this.state[l][o],u=this.state[l],i=this.state.map(function(t){return t[o]}),s=0;switch(e){case"left":for(var c=o-1;c>=0;c--)if(0===u[c])s++;else if(u[c]===a)return s+1;else break;return s;case"right":for(var v=o+1;v<u.length;v++)if(0===u[v])s++;else if(u[v]===a)return s+1;else break;return s;case"up":for(var f=l-1;f>=0;f--)if(0===i[f])s++;else if(i[f]===a)return s+1;else break;return s;case"down":for(var d=l+1;d<i.length;d++)if(0===i[d])s++;else if(i[d]===a)return s+1;else break;return s}}},{key:"start",value:function(){this.born(),this.born(),this.status="playing"}},{key:"restart",value:function(){this.state=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.status="idle",this.score=0,this.nextCellId=1}},{key:"check",value:function(){for(var t=0;t<this.state.length;t++)for(var e=0;e<this.state[t].length;e++){var n=this.state[t][e];if(null!==n&&n.value>=2048){this.status="win";return}if(!n)return;if(e<this.state[t].length-1){var r=this.state[t][e+1];if(null!==r&&r.value===n.value)return}if(t<this.state.length-1){var l=this.state[t+1][e];if(null!==l&&l.value===n.value)return}}this.status="lose"}},{key:"born",value:function(){for(var t=[],e=0;e<4;e++)for(var r=0;r<4;r++)null===this.state[e][r]&&t.push([e,r]);if(0!==t.length){var l=n(t[Math.floor(Math.random()*t.length)],2),o=l[0],a=l[1],u=.1>Math.random()?4:2,i={id:this.nextCellId++,value:u};return this.state[o][a]=i,{id:i.id,type:"spawn",to:[o,a],value:u}}}},{key:"performMove",value:function(t){var e;switch(t){case"LEFT":e=this.moveLeft();break;case"RIGHT":e=this.moveRight();break;case"UP":e=this.moveUp();break;case"DOWN":e=this.moveDown();break;default:return{newState:this.state,transitions:[],moved:!1}}if(e.moved){this.state=e.newState;var n=this.born();e.transitions.push(n),this.check()}return e}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(r.prototype,e),r}()),l=document.querySelector(".button"),o=document.querySelector(".game-field");Z;var a=document.querySelector(".game-score"),u=document.querySelector(".best-score"),i=document.querySelector(".message-start"),s=document.querySelector(".message-win"),c=document.querySelector(".message-lose"),v=!0;function f(t){if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&t.preventDefault(),"playing"===r.status&&v){var e,n=null;"keydown"===t.type&&t.key&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&(n=t.key.replace("Arrow","").toUpperCase()),["LEFT","RIGHT","UP","DOWN"].includes(n)&&(e=r.performMove(n)).moved&&(v=!1,e.transitions.forEach(function(t){var e=document.getElementById("cell-".concat(t.id));e&&("move"===t.type||"merge"===t.type)&&(e.style.transform="translate(".concat(83*t.to[1],"px, ").concat(83*t.to[0],"px)"))}),setTimeout(function(){e.transitions.forEach(function(t){if("merge"===t.type){var e=document.getElementById("cell-".concat(t.id)),n=document.getElementById("cell-".concat(t.mergeIntoId));if(e&&e.remove(),n){var l=r.state[t.to[0]][t.to[1]],a=l?l.value:0;n.textContent=a,n.className="cell cell--".concat(n.textContent)}}if("spawn"===t.type){var u=d(t.value,t.to[0],t.to[1],t.id);o.appendChild(u)}}),a.textContent=r.getScore(),r.getScore()>parseInt(u.textContent)&&(u.textContent=r.getScore(),localStorage.setItem("bestScore",r.getScore())),"lose"===r.status&&c.classList.remove("hidden"),"win"===r.status&&s.classList.remove("hidden"),v=!0},100))}}function d(t,e,n,r){var l=document.createElement("div");return l.id="cell-".concat(r),l.className="cell cell--".concat(t),l.textContent=t,l.style.transform="translate(".concat(83*n,"px, ").concat(83*e,"px)"),l}u.textContent=localStorage.getItem("bestScore")||0,l.addEventListener("click",function(){("idle"===r.status||(r.restart(),o.querySelectorAll(".cell").forEach(function(t){return t.remove()}),l.textContent="Start",l.classList.remove("restart"),l.classList.add("start"),a.textContent=r.getScore(),i.classList.remove("hidden"),c.classList.add("hidden"),s.classList.add("hidden"),document.removeEventListener("keydown",f),"idle"!==r.status||"Start"!==l.textContent))&&"Start"===l.textContent&&(r.start(),l.textContent="Restart",l.classList.remove("start"),l.classList.add("restart"),i.classList.add("hidden"),function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++){var r=t[e][n],l=r?r.value:0;if(0!==l){var a=d(l,e,n,r.id);o.appendChild(a)}}}(r.getState()),a.textContent=r.getScore(),document.addEventListener("keydown",f))})}();
//# sourceMappingURL=index.6d3d4475.js.map
